import{u as ue,j as e,P as he,r as o,J as j,L as pe,R as J,y as B,z as H,A as I,a9 as Z,B as _,af as Oe,V as De,aa as Me,ag as ze,ah as $e,K as Ae,a1 as Be,ai as He}from"./index-CZHDJBCk.js";import{A as je}from"./arrow-left-Dk0JVUuI.js";import{A as Ie,C as Ve,F as _e,S as Je}from"./ControlledAlertDialog-CSFfZjNE.js";import{F as Ge}from"./file-text-CxCffx7e.js";import{C as fe}from"./code-nd611ZK3.js";import{B as Ue}from"./book-open-DxhmDxZT.js";import{a as Ke,u as Xe,F as Ye}from"./index.esm-BBIM_QSt.js";import{u as be}from"./use-toast-DxaFKq84.js";import{a as k,b as L,c as F,d as E,e as P,M as qe}from"./markdown-form-field-DZLEdgmc.js";import{I as g}from"./index-CsZvwwPz.js";import{S as Qe,a as We,b as Ze,c as es,d as q}from"./select-DvMDIVW3.js";import{S as ee}from"./alert-dialog-B_LYbhSY.js";import{R as ne,a as X,F as ie,b as re,T as ss,C as ge,c as ve,P as ts,e as as,r as ls,d as ns}from"./TestResultLoading-DItjt0Yp.js";import{T as ce,a as oe,b as Q,c as de,d as is,e as rs,f as cs}from"./tabs-B72ujN-I.js";import{D as os,a as ds,b as ms,d as xs}from"./dropdown-menu-D8phL3t5.js";import{f as Ne}from"./toast-BdoThAHB.js";import{L as W}from"./label-990KbfKz.js";import{T as me}from"./textarea-BN4cbcHb.js";import{B as xe}from"./badge-DPmApw2E.js";import{X as se}from"./x-Br18mQUL.js";import{P as ye}from"./plus-CFaGAQ22.js";import{f as us,u as hs}from"./problemApi-DwmKlxuZ.js";import{L as ps}from"./overlay-CchFdlc6.js";import"./index-CpqmcsmY.js";import"./index-DQUYlbEB.js";import"./index-Dg4EHzo4.js";import"./index-Btbx0t0H.js";import"./axios-OWqOmaEp.js";import"./axios-CCb-kr4I.js";import"./index-Fh3QMK6n.js";function js({}){const s=ue();return e.jsx("header",{className:"sticky top-0 left-0 right-0 bg-white border-b border-gray-200 z-1",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 h-14 flex items-center justify-between",children:e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("button",{className:"text-black flex items-center hover:text-purple-700",onClick:()=>s({to:he}),children:[e.jsx(je,{className:"h-5 w-5 mr-2"}),e.jsx("span",{children:"Back To Problem List"})]})})})})}const V=[{id:"basic",label:"Basic Info",icon:Ge},{id:"code",label:"Code",icon:fe},{id:"description",label:"Template",icon:Ue}];function fs({activeTab:s,setActiveTab:t,isSaveTemplate:d,isRunSuccess:u,isLoadingSubmit:m}){const r=V.findIndex(C=>C.id===s),b=r===V.length-1,i=r===0,[f,R]=o.useState(!1),O=()=>R(!0),D=()=>R(!1),v=()=>{D()},z=()=>{i||t(V[r-1].id)},M=()=>{b||t(V[r+1].id)};return e.jsxs("div",{className:"sticky bottom-0 left-0 right-0 bg-white border-t border-gray-200",children:[e.jsx("div",{className:"max-w-4xl mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs(j,{type:"button",variant:"ghost",onClick:z,disabled:i,className:"flex items-center",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsx("div",{className:"flex justify-center space-x-4",children:V.map(C=>{const p=C.icon;return e.jsxs("button",{type:"button",className:`
          flex flex-row items-center justify-center px-4 relative
          ${s===C.id?"text-purple-600":"text-gray-600 hover:text-gray-900"}
        `,children:[e.jsx(p,{className:"h-5 w-5 mr-2"}),e.jsx("span",{className:"text-xs",children:C.label})]},C.id)})}),b&&e.jsx(e.Fragment,{children:m?e.jsx(e.Fragment,{children:e.jsxs(j,{type:"button",disabled:m,children:[e.jsx(pe,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]})}):e.jsx(j,{disabled:d===!1,type:"submit",variant:"default",className:"flex items-center",children:"Submit"})}),!b&&e.jsxs(j,{type:"button",variant:"ghost",onClick:u===!1&&s==="code"?O:M,className:"flex items-center",children:["Next",e.jsx(Ie,{className:"h-4 w-4 ml-2"})]})]})}),e.jsx(Ve,{isOpen:f,onClose:D,onConfirm:v,title:"Check the code again!",description:"You need to run the code and test case successfully before coming to the next step."})]})}function bs({form:s}){return e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsx("h1",{className:"mb-6 text-3xl font-semibold",children:"Create Code Problem - Basic Info"}),e.jsx("div",{className:"mb-6",children:e.jsx(k,{control:s.control,name:"title",render:({field:t})=>e.jsxs(L,{children:[e.jsx(F,{className:"text-base font-semibold",children:"Title"}),e.jsx(E,{children:e.jsx(g,{placeholder:"Enter problem title",...t})}),e.jsx(P,{})]})})}),e.jsx(qe,{control:s.control,name:"description",label:"Description",placeholder:"Enter problem description"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6",children:[e.jsx(k,{control:s.control,name:"difficultyType",render:({field:t})=>e.jsxs(L,{children:[e.jsx(F,{className:"text-base font-semibold",children:"Difficulty Type"}),e.jsxs(Qe,{onValueChange:t.onChange,defaultValue:t.value||"Medium",children:[e.jsx(E,{children:e.jsx(We,{children:e.jsx(Ze,{placeholder:"Select difficulty type"})})}),e.jsxs(es,{children:[e.jsx(q,{value:"Easy",children:"Easy"}),e.jsx(q,{value:"Medium",children:"Medium"}),e.jsx(q,{value:"Hard",children:"Hard"})]})]}),e.jsx(P,{})]})}),e.jsx(k,{control:s.control,name:"cpuTimeLimit",render:({field:t})=>e.jsxs(L,{children:[e.jsx(F,{className:"text-base font-semibold",children:"CPU Time Limit"}),e.jsx(E,{children:e.jsx(g,{min:.1,max:20,type:"number",step:"0.1",placeholder:"Enter CPU Time Limit",...t,value:t.value||2})}),e.jsx(P,{})]})}),e.jsx(k,{control:s.control,name:"cpuExtraTime",render:({field:t})=>e.jsxs(L,{children:[e.jsx(F,{className:"text-base font-semibold",children:"CPU Extra Time"}),e.jsx(E,{children:e.jsx(g,{min:0,max:5,type:"number",step:"0.1",placeholder:"Enter CPU Extra Time",...t,value:t.value||2.5})}),e.jsx(P,{})]})}),e.jsx(k,{control:s.control,name:"memoryLimit",render:({field:t})=>e.jsxs(L,{children:[e.jsx(F,{className:"text-base font-semibold",children:"Memory Limit (MB)"}),e.jsx(E,{children:e.jsx(g,{min:50,max:500,type:"number",step:"1",placeholder:"Enter Memory Limit",...t,value:t.value||250})}),e.jsx(P,{})]})}),e.jsx(k,{control:s.control,name:"stackLimit",render:({field:t})=>e.jsxs(L,{children:[e.jsx(F,{className:"text-base font-semibold",children:"Stack Limit (MB)"}),e.jsx(E,{children:e.jsx(g,{min:30,max:125,type:"number",step:"1",placeholder:"Enter Stack Limit",...t,value:t.value||64})}),e.jsx(P,{})]})}),e.jsx(k,{control:s.control,name:"maxThread",render:({field:t})=>e.jsxs(L,{children:[e.jsx(F,{className:"text-base font-semibold",children:"Max Thread"}),e.jsx(E,{children:e.jsx(g,{min:20,max:120,type:"number",step:"0.1",placeholder:"Enter Max Thread",...t,value:t.value||70})}),e.jsx(P,{})]})}),e.jsx(k,{control:s.control,name:"maxFileSize",render:({field:t})=>e.jsxs(L,{children:[e.jsx(F,{className:"text-base font-semibold",children:"Max File Size (MB)"}),e.jsx(E,{children:e.jsx(g,{min:1,max:20,type:"number",step:"1",placeholder:"Enter Max File Size",...t,value:t.value||10})}),e.jsx(P,{})]})}),e.jsx("div",{}),e.jsx(k,{control:s.control,name:"enableNetwork",render:({field:t})=>e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{className:"text-base font-semibold",children:"Enable Network"}),e.jsx(E,{children:e.jsx(ee,{className:"ml-2",checked:t.value,defaultChecked:!1,onCheckedChange:t.onChange})})]}),e.jsx(P,{})]})}),e.jsx(k,{control:s.control,name:"isActive",render:({field:t})=>e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{className:"text-base font-semibold",children:"Is Active"}),e.jsx(E,{children:e.jsx(ee,{className:"ml-2",checked:t.value,defaultChecked:!0,onCheckedChange:t.onChange})})]}),e.jsx(P,{})]})})]})]})}const gs=({testCases:s,setTestCases:t})=>{const[d,u]=o.useState([]),[m,r]=o.useState(""),[b,i]=o.useState(""),[f,R]=o.useState("");console.log(s),o.useEffect(()=>{if(s&&s.length>0){const n=Object.keys(s[0]).filter(a=>a!=="expectedOutput"&&a!=="isHidden"&&a!=="id");u(n)}},[s]);const O=()=>{m&&!d.includes(m)&&(u([...d,m]),r(""))},D=n=>{u(d.filter(a=>a!==n)),t(s.map(a=>{const{[n]:x,...N}=a;return N}))},v=()=>{const n=d.reduce((a,x)=>(a[x]="",a),{});t([...s,{...n,expectedOutput:"N/A",isHidden:!1}])},z=(n,a,x)=>{const N=[...s];N[n][a]=x,t(N)},M=(n,a)=>{const x=[...s];x[n].expectedOutput=a,t(x)},C=n=>{t(s.filter((a,x)=>x!==n))},p=n=>{const a=[...s];a[n].isHidden=!a[n].isHidden,t(a)};o.useEffect(()=>{const n=s.flatMap(x=>d.map(N=>`${x[N]}`)).join(`
`);i(n);const a=JSON.stringify(s.map(x=>({Output:x.expectedOutput,Stdout:""})),null,2);R(a)},[s,d]);const $=()=>{t([...s,{expectedOutput:"",isHidden:!1}])};return e.jsxs(B,{className:"w-full mx-auto",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(H,{children:e.jsx(I,{className:"text-center text-2xl font-semibold",children:"Test Case Generator"})})}),e.jsx(Z,{className:"flex flex-col items-stretch gap-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:`col-span-2 grid  ${s.length===0?"rounded-xl border-2 border-dashed border-gray-300 flex items-center justify-center":"grid-cols-2 gap-4"}`,children:[s.length===0&&e.jsx("p",{className:"text-center text-gray-500 w-full font-semibold",children:"No test cases created yet."}),s.map((n,a)=>{const{id:x,...N}=n;return e.jsxs(B,{className:"w-full mb-4",children:[e.jsxs(H,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxs(I,{className:"text-sm font-semibold",children:["Test Case ",a+1]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(W,{htmlFor:`hidden-toggle-${a}`,children:"Hidden"}),e.jsx(ee,{id:`hidden-toggle-${a}`,checked:n.isHidden,onCheckedChange:()=>p(a)})]}),e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>C(a),children:e.jsx(se,{className:"h-4 w-4"})})]})]}),e.jsxs(_,{children:[Object.entries(N).map(([y,G])=>y!=="expectedOutput"&&y!=="isHidden"&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(W,{htmlFor:`${a}-${y}`,className:"w-1/3",children:e.jsx(xe,{variant:"outline",className:"mr-2",children:y})}),e.jsx(g,{id:`${a}-${y}`,value:G,onChange:A=>z(a,y,A.target.value),className:"w-2/3"})]},y)),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(W,{htmlFor:`${a}-expectedOutput`,className:"w-1/3",children:e.jsx(xe,{variant:"outline",className:"mr-2",children:"Expected Output"})}),e.jsx(g,{id:`${a}-expectedOutput`,value:n.expectedOutput,onChange:y=>M(a,y.target.value),className:"w-2/3"})]})]})]},x||a)})]}),e.jsxs("div",{children:[e.jsxs(B,{className:"w-full mb-4",children:[e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(g,{placeholder:"Enter parameter name",value:m,onChange:n=>r(n.target.value),onKeyDown:n=>{n.key==="Enter"&&(n.preventDefault(),O())}}),e.jsxs(j,{type:"button",onClick:O,className:"flex-shrink-0",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Add Param"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(n=>e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-full px-3 py-1",children:[e.jsx("span",{children:n}),e.jsx(j,{variant:"ghost",size:"sm",className:"ml-2 p-0 h-auto",onClick:()=>D(n),children:e.jsx(se,{className:"w-4 h-4"})})]},n))})]}),e.jsxs(Z,{children:[e.jsx(j,{type:"button",onClick:v,disabled:d.length===0,className:"w-fit",children:"Create Test Case"}),e.jsx(j,{type:"button",onClick:$,className:"w-fit ml-2",children:"Create No Parameters"})]})]}),e.jsxs(B,{className:"w-full mb-4",children:[e.jsx(H,{children:e.jsx(I,{children:"Preview Input"})}),e.jsx(_,{children:e.jsx(me,{value:b,readOnly:!0,className:"w-full h-40"})})]}),e.jsxs(B,{className:"w-full",children:[e.jsx(H,{children:e.jsx(I,{children:"Preview Output"})}),e.jsx(_,{children:e.jsx(me,{value:f,readOnly:!0,className:"w-full h-40"})})]})]})]})})]})},vs=J.memo(gs),Ns=({testCases:s,selectedIndex:t,onSelect:d,failedTestCases:u=[]})=>e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:s.map((m,r)=>e.jsxs(j,{type:"button",variant:t===r?"default":"outline",className:`${u.includes(r)?"bg-red-100 hover:bg-red-200 text-red-700":"bg-emerald-100 hover:bg-emerald-200 text-emerald-700"} ${t===r?"border-2 border-emerald-500":""}`,onClick:()=>d(r),children:["Case ",r+1]},r))}),ys=({result:s})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Inputs:"}),Object.entries(s.inputs).map(([t,d])=>e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[t," ="]}),e.jsx(g,{className:"font-mono bg-muted",value:d,readOnly:!0})]},t))]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Expected Output ="}),e.jsx(g,{className:"font-mono bg-muted",value:s.expected,readOnly:!0})]}),s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Actual Output ="}),e.jsx(g,{className:"font-mono bg-muted",value:s.output,readOnly:!0})]}),e.jsxs("div",{className:`flex items-center gap-2 ${s.isPass?"text-green-600":"text-red-600"}`,children:[s.isPass?e.jsx(ve,{className:"w-5 h-5"}):e.jsx(ge,{className:"w-5 h-5"}),e.jsx("span",{children:s.isPass?"Passed":"Failed"})]})]})]}),Ts=({solutions:s,selectedIndex:t,onSelect:d,failedSolutions:u=[]})=>e.jsx("div",{className:"flex items-center gap-2 flex-wrap mb-4",children:s.map((m,r)=>e.jsxs(j,{type:"button",variant:t===r?"default":"outline",className:`${u.includes(r)?"bg-red-100 hover:bg-red-200 text-red-700":"bg-blue-100 hover:bg-blue-200 text-blue-700"} ${t===r?"border-2 border-blue-500":""}`,onClick:()=>d(r),children:["Solution ",r+1]},r))}),Cs=({result:s})=>e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"Status: "}),e.jsx("span",{className:s.status.id===3?"text-green-600":"text-red-600",children:s.status.description})]}),s.compileErrors&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-red-600",children:"Compile Errors: "}),e.jsx("pre",{className:"bg-red-100 p-2 rounded text-sm overflow-x-auto",children:s.compileErrors})]}),s.runTimeErrors&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-red-600",children:"Runtime Errors: "}),e.jsx("pre",{className:"bg-red-100 p-2 rounded text-sm overflow-x-auto",children:s.runTimeErrors})]})]}),ws=({form:s,setIsRunSuccess:t,testCaseUpdate:d,solutionUpdate:u})=>{var le;const[m,r]=o.useState([{id:null,name:"Solution.java",content:""}]),[b,i]=o.useState("Solution.java"),[f,R]=o.useState(""),[O,D]=o.useState("testcase"),[v,z]=o.useState(0),[M,C]=o.useState(null),[p,$]=o.useState([]),[n,a]=o.useState(0),[x,N]=o.useState(null),[y,G]=o.useState(!1),{toast:A}=be(),{setValue:te}=s;o.useEffect(()=>{if(d){const l=Oe(d);$(l)}},[d]),o.useEffect(()=>{if(u.solutions&&u.solutions.length>0){const l=u.solutions.map((c,h)=>({id:c.id,name:h===0?"Solution.java":`Solution${h}.java`,content:c.solutionCode}));r(l),i(l[0].name)}u.testCode&&R(u.testCode)},[u]);const Te=()=>{const c=`Solution${Math.max(...m.map(h=>{const T=h.name.match(/Solution(\d+)\.java/);return T?parseInt(T[1]):0}))+1}.java`;r(h=>[...h,{id:null,name:c,content:""}]),i(c),t(!1)},Ce=()=>{const l=m.every(h=>h.content.trim()!==""),c=f.trim()!=="";return l&&c},we=l=>{if(m.length>1){const c=m.findIndex(T=>T.name===l),h=m.filter(T=>T.name!==l);for(let T=c;T<h.length;T++){const U=h[T].name.match(/Solution(\d+)\.java/);if(U){const Y=parseInt(U[1])-1;h[T].name=`Solution${Y}.java`}}r(h),b===l&&i(h[c]?h[c].name:h[h.length-1].name)}},Se=l=>{r(c=>c.map(h=>h.name===b?{...h,content:l}:h))},ke=l=>{R(l)},Le=async()=>{if(!Ce()){A({variant:"destructive",title:"Empty Code or Test Content",description:"Your code or test content is empty, please check again"});return}G(!0),D("result");const l=s.getValues(),c={resourceLimits:{cpuTimeLimit:l.cpuTimeLimit,cpuExtraTime:l.cpuExtraTime,memoryLimit:l.memoryLimit*1024,enableNetwork:l.enableNetwork,stackLimit:l.stackLimit*1024,maxThread:l.maxThread,maxFileSize:l.maxFileSize*1024}},T={batchCodeExecuteDto:{languageCode:"Java",testCases:ze(p).testCases,solutionCodes:m.map(S=>S.content),testCode:f},resourceLimits:c.resourceLimits},U=$e(p);te("testCases",U.testCases);const Y=[{fileName:"Main.java",template:"",testCode:f,description:"",languageCode:"Java",solutions:m.map(S=>({id:S.id,fileName:"Main.java",solutionCode:S.content,description:"",languageCode:"Java",priority:!0}))}];te("testcripts",Y);try{const S=await ls(T);if(N(S.codeExecuteDtos),S.codeExecuteDtos.some(K=>K.compileErrors||K.runTimeErrors)){A({variant:"destructive",title:"Runcode Result",description:"There are compile or runtime errors. Please check your code."}),t(!1);return}S.codeExecuteDtos.some(K=>K.testResults.some(Re=>!Re.isPass))?(A({variant:"destructive",title:"Runcode Result",description:"Some test cases failed, please check your code again"}),t(!1)):(A({variant:"success",title:"Runcode Result",description:"All test cases passed successfully!"}),t(!0))}catch(S){A({variant:"destructive",title:"Runcode Result",description:"There was a problem with your request.",action:e.jsx(Ne,{altText:"Try again",children:"Try again"})}),t(!1),console.error("Error creating course:",S)}finally{G(!1)}},Fe=l=>Object.keys(l).filter(c=>c!=="expectedOutput"&&c!=="isHidden"&&c!=="id"),w=x&&x[n],ae=w&&w.testResults[v],Ee=x?x.map((l,c)=>l.status.id!==3?c:-1).filter(l=>l!==-1):[],Pe=w&&w.testResults?w.testResults.map((l,c)=>l.isPass?-1:c).filter(l=>l!==-1):[];return e.jsxs("div",{className:"flex flex-col",children:[e.jsx(vs,{testCases:p,setTestCases:$}),e.jsx("div",{className:"flex justify-center",children:e.jsx(H,{children:e.jsx(I,{className:"text-center text-2xl font-semibold",children:"Create Code Problem"})})}),e.jsx("div",{className:"h-[800px] rounded-xl border z-0",children:e.jsxs(ne,{direction:"vertical",children:[e.jsx(X,{defaultSize:70,children:e.jsxs(ne,{direction:"horizontal",children:[e.jsx(X,{defaultSize:50,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b bg-background shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5"}),e.jsx("h2",{className:"text-sm font-medium",children:"Solution"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(os,{children:[e.jsx(ds,{asChild:!0,children:e.jsxs(j,{variant:"outline",className:"w-[200px] justify-between",children:[b,e.jsx(De,{className:"ml-2 h-4 w-4 opacity-50"})]})}),e.jsx(ms,{className:"w-[200px]",children:m.map(l=>e.jsxs(xs,{onSelect:()=>i(l.name),className:"justify-between",children:[l.name,m.length>1&&e.jsx(j,{type:"button",variant:"ghost",size:"icon",className:"h-4 w-4 p-0",onClick:c=>{c.stopPropagation(),we(l.name)},children:e.jsx(se,{className:"h-3 w-3"})})]},l.name))})]}),e.jsx(j,{type:"button",variant:"ghost",size:"icon",onClick:Te,children:e.jsx(ye,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"flex-1 w-full min-h-0",children:e.jsx(ie,{height:"100%",defaultLanguage:"java",theme:"vs-dark",value:((le=m.find(l=>l.name===b))==null?void 0:le.content)||"",onChange:Se,options:{minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,automaticLayout:!0,lineNumbers:"on",lineNumbersMinChars:3,padding:{top:10,bottom:10}}})})]})}),e.jsx(re,{}),e.jsx(X,{defaultSize:50,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b bg-background shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ss,{className:"w-5 h-5"}),e.jsx("h2",{className:"text-sm font-medium",children:"Test"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ce,{value:"test.java",className:"flex-1",children:e.jsx(oe,{className:"p-0 bg-transparent h-7",children:e.jsx(Q,{value:"test.java",className:"relative px-3 text-xs bg-background text-foreground h-7",children:"Main.java"})})})})]}),e.jsx("div",{className:"flex-1 w-full min-h-0",children:e.jsx(ie,{height:"100%",defaultLanguage:"java",theme:"vs-dark",value:f,onChange:ke,options:{minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,automaticLayout:!0,lineNumbers:"on",lineNumbersMinChars:3,padding:{top:10,bottom:10}}})})]})})]})}),e.jsx(re,{}),e.jsx(X,{defaultSize:30,children:e.jsx(B,{className:"flex h-full flex-col rounded-none",children:e.jsxs(ce,{value:O,onValueChange:D,className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-2 bg-gray-400",children:[e.jsxs(oe,{children:[e.jsx(Q,{value:"testcase",children:"Testcase"}),e.jsx(Q,{value:"result",children:"Test Result"})]}),M===!1&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"text-red-700 w-8 h-8"}),e.jsx("p",{className:"text-red-700 font-medium",children:"Failed, please check Test Result"})]}),M===!0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"text-green-700 w-8 h-8"}),e.jsx("p",{className:"text-green-700 font-medium",children:"Success, you can move to the next step."})]}),e.jsx(j,{type:"button",onClick:Le,disabled:y,children:y?e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"mr-2 h-4 w-4 animate-spin"}),"Running..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ts,{className:"mr-2 h-4 w-4"}),"Run"]})})]}),e.jsxs(Me,{className:"flex-1",children:[e.jsx(de,{value:"testcase",className:"p-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:p.map((l,c)=>e.jsxs(j,{type:"button",variant:v===c?"default":"outline",className:"bg-emerald-100 hover:bg-emerald-200 text-emerald-700",onClick:()=>z(c),children:["Case ",c+1]},c))}),p[v]&&e.jsx("div",{className:"space-y-4",children:Fe(p[v]).map(l=>e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:[l," ="]}),e.jsx(g,{className:"font-mono bg-muted",value:p[v][l],readOnly:!0})]},l))})]})}),e.jsx(de,{value:"result",className:"p-4",children:x?y?e.jsx(as,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ts,{solutions:x,selectedIndex:n,onSelect:a,failedSolutions:Ee}),w&&w.testResults&&w.testResults.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Ns,{testCases:w.testResults,selectedIndex:v,onSelect:z,failedTestCases:Pe}),ae&&e.jsx(ys,{result:ae})]}),e.jsx(Cs,{result:w})]}):e.jsx("div",{className:"text-center text-lg font-medium text-gray-500",children:"Please run Code First"})})]})]})})})]})})]})},Ss=o.memo(ws),ks=({setIsSaveTemplate:s,templateUpdate:t})=>{const[d,u]=o.useState(""),{setValue:m,getValues:r}=Ke();J.useEffect(()=>{t&&u(t)},[t]);const b=f=>{u(f||"")},i=()=>{const f=r("testcripts");f[0].template=d,m("testcripts",f),s(!0)};return e.jsxs(B,{className:"w-full max-w-4xl mx-auto",children:[e.jsxs(H,{children:[e.jsx(I,{children:"Final Step: Set Up Problem Template"}),e.jsx(Ae,{children:"This is the last step in creating your programming problem. Here, you can set up the initial code template that learners will see when they start the problem. Include any necessary class structures, method signatures, or comments to guide the learners."})]}),e.jsx(_,{children:e.jsxs("div",{className:"flex flex-col h-[400px] border rounded-md overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b bg-background shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-5 h-5"}),e.jsx("h2",{className:"text-sm font-medium",children:"Problem Template"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(is,{defaultValue:"solution.java",className:"flex-1",children:e.jsx(rs,{className:"h-8 p-0 bg-transparent",children:e.jsx(cs,{value:"solution.java",className:"px-3 text-xs h-8 data-[state=active]:bg-muted",children:"Solution.java"})})})})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(ns,{height:"100%",defaultLanguage:"java",theme:"vs-dark",value:d,onChange:b,options:{minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,automaticLayout:!0,lineNumbers:"on",lineNumbersMinChars:3,padding:{top:10,bottom:10}}})})]})}),e.jsx(Z,{className:"flex justify-between",children:e.jsxs(j,{type:"button",onClick:i,children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Save"]})})]})},Ls=J.memo(ks),Fs=({activeTab:s,form:t,setIsSaveTemplate:d,setIsRunSuccess:u,testCaseUpdate:m,solutionUpdate:r})=>e.jsx("div",{className:"mx-auto px-4 py-24",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{style:{display:s==="basic"?"block":"none"},children:e.jsx(bs,{form:t})}),e.jsx("div",{style:{display:s==="code"?"block":"none"},children:e.jsx(Ss,{form:t,setIsRunSuccess:u,testCaseUpdate:m,solutionUpdate:r})}),e.jsx("div",{style:{display:s==="description"?"block":"none"},children:e.jsx(Ls,{form:t,setIsSaveTemplate:d,templateUpdate:r.template})})]})}),Es=J.memo(Fs),Ps=({})=>{const[s,t]=o.useState("basic"),[d,u]=o.useState(!1),{toast:m}=be(),[r,b]=o.useState(!1),[i,f]=o.useState(null),[R,O]=o.useState(!0),[D,v]=o.useState(!1),{params:z}=Be(He.id),{problemId:M}=z,C=ue(),p=Xe({defaultValues:{title:"",description:"",problemType:"Challenge",difficultyType:"Medium",cpuTimeLimit:2,cpuExtraTime:2.5,memoryLimit:250,stackLimit:64,maxThread:70,maxFileSize:10,enableNetwork:!1,isActive:!0,testCases:{},createTestScriptDto:[]}});if(o.useEffect(()=>{(async()=>{try{const a=await us(M);f(a.problemDetailsDto),O(!1)}catch(a){console.error("Error get problem detail:",a),O(!1)}})()},[]),o.useEffect(()=>{i&&p.reset({title:i.title||"",description:i.description||"",problemType:i.problemType||"Challenge",difficultyType:i.difficultyType||"Medium",cpuTimeLimit:i.cpuTimeLimit||2,cpuExtraTime:i.cpuExtraTime||2.5,memoryLimit:(i.memoryLimit||250)/1024,stackLimit:(i.stackLimit||64)/1024,maxThread:i.maxThread||70,maxFileSize:(i.maxFileSize||10)/1024,enableNetwork:i.enableNetwork||!1,isActive:i.isActive||!0,testCases:i.testCases||{},testcripts:i.testScrips||[]})},[i,p]),R)return e.jsx(ps,{});const $=async n=>{const a={...n};a.memoryLimit=a.memoryLimit*1024,a.maxFileSize=a.maxFileSize*1024,a.stackLimit=a.stackLimit*1024;const x={problem:a};v(!0);try{const N=await hs(x,M);m({variant:"success",title:"Update problem successfully",description:"Update problem successfully"}),C({to:he})}catch(N){m({variant:"destructive",title:"Oops! Something went wrong",description:"Please try again!",action:e.jsx(Ne,{altText:"Try again",onClick:()=>$(p.getValues()),children:"Try again"})}),console.error("Error updating problem:",N)}finally{v(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(js,{backTo:"Back to Curriculum"}),e.jsx(Ye,{...p,children:e.jsxs("form",{onSubmit:p.handleSubmit($),children:[e.jsx(Es,{activeTab:s,form:p,setIsSaveTemplate:u,setIsRunSuccess:b,testCaseUpdate:i==null?void 0:i.testCases,solutionUpdate:i==null?void 0:i.testScrips[0]}),e.jsx(fs,{activeTab:s,setActiveTab:t,isSaveTemplate:d,isRunSuccess:r,isLoadingSubmit:D})]})})]})},dt=J.memo(Ps);export{dt as default};
//# sourceMappingURL=UpdateProblemAg-D2hQ4iJw.js.map
