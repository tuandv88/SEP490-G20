import{r as j,j as e,Y as ue,E as v,q as S,x as L,v as V,w as X,H as I}from"./index--0QK1py9.js";import{S as O,A as ve,b as ye,c as Ce,d as qe,e as be,f as we,g as Ae,h as Te}from"./alert-dialog-44o-75vc.js";import{u as te,b as he,C as o,F as Se}from"./index.esm-DpCIhZqu.js";import{o as Z,s as _,b as P,e as G,n as xe,a as pe,t as ie,c as se,Z as J}from"./index-eHZHAmfB.js";import{I as F}from"./index-DCCljha-.js";import{L as m}from"./label--2Dd6Xb2.js";import{S as $,a as H,b as U,c as Y,d as M}from"./select-CkkvPfhu.js";import{D as ne,a as ae,b as re,c as le,d as ce,g as ze,e as Le}from"./dialog-Bx1Lxwmr.js";import{c as ke,u as Ee,A as Qe,a as Oe,b as Fe,I as De,d as Ie,g as Me,e as Re,f as Pe}from"./accordion-CsjeTkUs.js";import{u as ee}from"./use-toast-BSHZ4QUe.js";import{T as K}from"./trash-2-hRCeANK2.js";import{P as W}from"./plus-C3zHGkbA.js";import{a as je,g as Ve}from"./quizApi-D8sdSUEe.js";import{M as $e}from"./markdown-form-field-21-JDoZJ.js";import{P as C}from"./index-BzgUoul7.js";import{B as fe}from"./badge-v9T6Y60L.js";import{T as He,a as Ue,b as Ye,c as _e}from"./tooltip-CP8HNIJZ.js";import{e as Be}from"./problemApi-D_lYKErb.js";import{C as Xe}from"./code-0wckQy-k.js";import{F as ge}from"./file-question-C391iaKW.js";import{S as me}from"./square-pen-CIUUGTRb.js";import{C as Ze}from"./clock-BLEnB3YY.js";import{R as Ge}from"./rotate-ccw-DYPL32qL.js";import"./index-DdpAazCY.js";import"./index-goUZiQpb.js";import"./index-CaMr_zbb.js";import"./axios-CDwYrkV6.js";import"./axios-CCb-kr4I.js";const Je=["MultipleChoice","MultipleSelect","TrueFalse"],Ke=["EASY","MEDIUM","HARD","EXPERT"],We=Z({content:_().min(1,"Content is required"),isActive:P(),questionType:G(["MultipleChoice","MultipleSelect","TrueFalse","CodeSnippet"]),questionLevel:G(["EASY","MEDIUM","HARD","EXPERT"]),mark:xe().min(1,"Mark must be at least 1"),questionOptions:pe(Z({content:_().min(1,"Option content is required"),isCorrect:P()})).min(2,"At least two answer options are required").refine(r=>r.some(d=>d.isCorrect),{message:"At least one correct answer is required",path:["questionOptions"]})});function es({onClose:r,quizId:d,onQuestionAdded:D}){var h;const[z,g]=j.useState("MultipleChoice"),{toast:E}=ee(),[N,c]=j.useState(!1),{control:u,handleSubmit:q,formState:{errors:n},watch:f,setValue:x,trigger:t}=te({resolver:ie(We),defaultValues:{content:"",isActive:!0,questionType:"MultipleChoice",questionLevel:"EASY",mark:1,questionOptions:[{content:"",isCorrect:!0},{content:"",isCorrect:!1}]}}),{fields:p,append:b,remove:k}=he({control:u,name:"questionOptions"}),Q=f("questionType"),w=f("questionOptions");j.useEffect(()=>{if(Q==="MultipleChoice"&&w.filter(i=>i.isCorrect).length>1){const i=w.findIndex(s=>s.isCorrect);w.forEach((s,a)=>{x(`questionOptions.${a}.isCorrect`,a===i)})}t("questionOptions")},[Q,w,x,t]),j.useEffect(()=>{w&&(c(!1),t("questionOptions"))},[w,t]);const A=async l=>{if(c(!0),Object.keys(n).length>0)return;const i=l.questionOptions.map((a,T)=>({...a,orderIndex:T})),s={createQuestionDto:{...l,questionOptions:i}};try{await ke(s,d),E({title:"Success",description:"Question created successfully",duration:1500}),D(),r()}catch{}};return e.jsx(ne,{open:!0,onOpenChange:r,children:e.jsxs(ae,{className:"max-w-[500px] h-[600px] p-0 overflow-hidden flex flex-col",children:[e.jsx(re,{className:"px-6 py-4 border-b",children:e.jsx(le,{className:"text-xl font-semibold",children:"Add New Question"})}),e.jsx(ue,{className:"flex-grow px-6 py-4",children:e.jsxs("form",{onSubmit:q(A),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"content",children:"Question Content"}),e.jsx(o,{name:"content",control:u,render:({field:l})=>e.jsx(F,{id:"content",...l,placeholder:"Enter your question here"})}),N&&n.content&&e.jsx("p",{className:"text-sm text-red-500",children:n.content.message})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{name:"isActive",control:u,render:({field:l})=>e.jsx(O,{id:"isActive",checked:l.value,onCheckedChange:l.onChange})}),e.jsx(m,{htmlFor:"isActive",children:"Active"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"questionType",children:"Question Type"}),e.jsx(o,{name:"questionType",control:u,render:({field:l})=>e.jsxs($,{onValueChange:i=>{l.onChange(i),g(i)},value:l.value,children:[e.jsx(H,{id:"questionType",children:e.jsx(U,{placeholder:"Select type"})}),e.jsx(Y,{children:Je.map(i=>e.jsx(M,{value:i,children:i},i))})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"questionLevel",children:"Difficulty Level"}),e.jsx(o,{name:"questionLevel",control:u,render:({field:l})=>e.jsxs($,{onValueChange:l.onChange,value:l.value,children:[e.jsx(H,{id:"questionLevel",children:e.jsx(U,{placeholder:"Select level"})}),e.jsx(Y,{children:Ke.map(i=>e.jsx(M,{value:i,children:i.charAt(0)+i.slice(1).toLowerCase()},i))})]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"mark",children:"Mark"}),e.jsx(o,{name:"mark",control:u,render:({field:l})=>e.jsx(F,{id:"mark",type:"number",...l,onChange:i=>l.onChange(parseInt(i.target.value)),min:1})}),N&&n.mark&&e.jsx("p",{className:"text-sm text-red-500",children:n.mark.message})]}),(z==="MultipleChoice"||z==="MultipleSelect")&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Answer Options"}),e.jsx("div",{className:"max-h-[200px] overflow-y-auto pr-2",children:p.map((l,i)=>{var s,a;return e.jsxs("div",{className:"flex flex-col gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{name:`questionOptions.${i}.content`,control:u,render:({field:T})=>e.jsx(F,{...T,placeholder:`Option ${i+1}`,className:"flex-1"})}),e.jsx(o,{name:`questionOptions.${i}.isCorrect`,control:u,render:({field:{value:T,onChange:y}})=>e.jsx(O,{checked:T,onCheckedChange:R=>{z==="MultipleChoice"&&R?w.forEach((oe,B)=>{x(`questionOptions.${B}.isCorrect`,B===i)}):y(R),t("questionOptions")},className:"mx-2"})}),e.jsx(v,{type:"button",variant:"ghost",size:"icon",onClick:()=>k(i),className:"h-8 w-8",disabled:p.length<=2,children:e.jsx(K,{className:"h-4 w-4"})})]}),N&&((a=(s=n.questionOptions)==null?void 0:s[i])==null?void 0:a.content)&&e.jsx("p",{className:"text-sm text-red-500",children:n.questionOptions[i].content.message})]},l.id)})}),N&&n.questionOptions&&"root"in n.questionOptions&&e.jsx("p",{className:"text-sm text-red-500",children:(h=n.questionOptions.root)==null?void 0:h.message}),e.jsxs(v,{type:"button",onClick:()=>b({content:"",isCorrect:!1}),variant:"outline",className:"w-full mt-2",children:[e.jsx(W,{className:"h-4 w-4 mr-2 mt-1"}),"Add Answer Option"]})]}),Q==="TrueFalse"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Correct Answer"}),e.jsx(o,{name:"questionOptions",control:u,defaultValue:[{content:"True",isCorrect:!0},{content:"False",isCorrect:!1}],render:({field:l})=>e.jsxs($,{onValueChange:i=>l.onChange([{content:"True",isCorrect:i==="True"},{content:"False",isCorrect:i==="False"}]),defaultValue:"True",children:[e.jsx(H,{children:e.jsx(U,{placeholder:"Select correct answer"})}),e.jsxs(Y,{children:[e.jsx(M,{value:"True",children:"True"}),e.jsx(M,{value:"False",children:"False"})]})]})})]})]})}),e.jsx(ce,{className:"px-6 py-4 border-t",children:e.jsxs("div",{className:"flex justify-end space-x-2 w-full",children:[e.jsx(v,{variant:"outline",onClick:r,children:"Cancel"}),e.jsx(v,{onClick:()=>{c(!0),q(A)()},children:"Add Question"})]})})]})})}const ss=Z({title:_().min(1,"Title is required"),description:_().min(1,"Description is required"),passingMark:se.number().int("Passing mark must be an integer").min(1,"Passing mark must be a non-negative integer"),hasTimeLimit:P(),timeLimit:se.number().int("Time limit must be an integer").optional(),hasAttemptLimit:P(),attemptLimit:se.number().int("Attempt limit must be an integer").optional(),isActive:P(),isRandomized:P(),quizType:G(["ASSESSMENT"])}).superRefine((r,d)=>{r.hasTimeLimit&&(r.timeLimit===void 0?d.addIssue({code:J.custom,message:"Time limit is required when 'Has Time Limit' is enabled",path:["timeLimit"]}):r.timeLimit<1&&d.addIssue({code:J.custom,message:"Time limit must be at least 1 minute when enabled",path:["timeLimit"]})),r.hasAttemptLimit&&(r.attemptLimit===void 0?d.addIssue({code:J.custom,message:"Attempt limit is required when 'Has Attempt Limit' is enabled",path:["attemptLimit"]}):r.attemptLimit<1&&d.addIssue({code:J.custom,message:"Attempt limit must be at least 1 when enabled",path:["attemptLimit"]}))});function ts({isOpen:r,onOpenChange:d,onSubmit:D}){const z=te({resolver:ie(ss),defaultValues:{title:"",description:"",passingMark:1,hasTimeLimit:!1,timeLimit:1,hasAttemptLimit:!1,attemptLimit:1,isActive:!0,isRandomized:!1,quizType:"ASSESSMENT"}}),{control:g,handleSubmit:E,watch:N,formState:{errors:c,isSubmitting:u}}=z,q=N("hasTimeLimit"),n=N("hasAttemptLimit"),{toast:f}=ee(),x=async t=>{try{const p={createQuizDto:{isActive:t.isActive,isRandomized:t.isRandomized,title:t.title,description:t.description,passingMark:t.passingMark,timeLimit:t.hasTimeLimit?t.timeLimit:void 0,hasTimeLimit:t.hasTimeLimit,attemptLimit:t.hasAttemptLimit?t.attemptLimit:void 0,hasAttemptLimit:t.hasAttemptLimit,quizType:t.quizType}};console.log(p);const b=await je(p);D(b),d(!1),f({title:"Quiz Created",description:"Your quiz has been successfully created."})}catch(p){console.error("Error creating quiz:",p),f({title:"Error",description:"Failed to create quiz. Please try again.",variant:"destructive"})}};return e.jsx(ne,{open:r,onOpenChange:d,children:e.jsxs(ae,{className:"sm:max-w-[900px] max-h-[90vh]",children:[e.jsxs(re,{children:[e.jsx(le,{className:"text-2xl font-bold",children:"Create Quiz"}),e.jsx(ze,{children:"Fill in the details to create a new quiz."})]}),e.jsx(Se,{...z,children:e.jsxs("form",{onSubmit:E(x),children:[e.jsxs("div",{className:"space-y-6 py-4 overflow-y-auto pr-6",style:{maxHeight:"calc(90vh - 200px)"},children:[e.jsx(S,{children:e.jsx(L,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"title",className:"text-sm font-medium",children:"Title"}),e.jsx(o,{name:"title",control:g,render:({field:t})=>e.jsx(F,{...t,id:"title",className:"w-full"})}),c.title&&e.jsx("p",{className:"text-sm text-red-500",children:c.title.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"passingMark",className:"text-sm font-medium",children:"Passing Mark"}),e.jsx(o,{name:"passingMark",control:g,render:({field:t})=>e.jsx(F,{...t,id:"passingMark",type:"number",className:"w-full"})}),c.passingMark&&e.jsx("p",{className:"text-sm text-red-500",children:c.passingMark.message})]})]})})}),e.jsx(S,{children:e.jsx(L,{className:"pt-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"description",className:"text-sm font-medium",children:"Description"}),e.jsx($e,{control:g,name:"description",label:"",placeholder:"Enter quiz description"}),c.description&&e.jsx("p",{className:"text-sm text-red-500",children:c.description.message})]})})}),e.jsx(S,{children:e.jsx(L,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"hasTimeLimit",className:"text-sm font-medium",children:"Has Time Limit"}),e.jsx(o,{name:"hasTimeLimit",control:g,render:({field:t})=>e.jsx(O,{checked:t.value,onCheckedChange:t.onChange})})]}),q&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"timeLimit",className:"text-sm font-medium",children:"Time Limit (minutes)"}),e.jsx(o,{name:"timeLimit",control:g,render:({field:t})=>e.jsx(F,{...t,id:"timeLimit",type:"number",className:"w-full"})}),c.timeLimit&&e.jsx("p",{className:"text-sm text-red-500",children:c.timeLimit.message})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"hasAttemptLimit",className:"text-sm font-medium",children:"Has Attempt Limit"}),e.jsx(o,{name:"hasAttemptLimit",control:g,render:({field:t})=>e.jsx(O,{checked:t.value,onCheckedChange:t.onChange})})]}),n&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"attemptLimit",className:"text-sm font-medium",children:"Attempt Limit"}),e.jsx(o,{name:"attemptLimit",control:g,render:({field:t})=>e.jsx(F,{...t,id:"attemptLimit",type:"number",className:"w-full"})}),c.attemptLimit&&e.jsx("p",{className:"text-sm text-red-500",children:c.attemptLimit.message})]})]})]})})}),e.jsx(S,{children:e.jsx(L,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"isActive",className:"text-sm font-medium",children:"Is Active"}),e.jsx(o,{name:"isActive",control:g,render:({field:t})=>e.jsx(O,{checked:t.value,onCheckedChange:t.onChange})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"isRandomized",className:"text-sm font-medium",children:"Is Randomized"}),e.jsx(o,{name:"isRandomized",control:g,render:({field:t})=>e.jsx(O,{checked:t.value,onCheckedChange:t.onChange})})]})]})})}),e.jsx(S,{children:e.jsx(L,{className:"pt-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"quizType",className:"text-sm font-medium",children:"Quiz Type"}),e.jsx(o,{name:"quizType",control:g,render:({field:t})=>e.jsxs($,{onValueChange:t.onChange,defaultValue:t.value,children:[e.jsx(H,{className:"w-full",children:e.jsx(U,{placeholder:"Select quiz type"})}),e.jsx(Y,{children:e.jsx(M,{value:"ASSESSMENT",children:"Assessment"})})]})})]})})})]}),e.jsxs(ce,{className:"mt-6",children:[e.jsx(Le,{asChild:!0,children:e.jsx(v,{type:"button",variant:"secondary",children:"Cancel"})}),e.jsx(v,{type:"submit",disabled:u,children:u?"Creating...":"Create Quiz"})]})]})})]})})}const is=["MultipleChoice","MultipleSelect","TrueFalse"],ns=["EASY","MEDIUM","HARD","EXPERT"],as=Z({content:_().min(1,"Content is required"),isActive:P(),questionType:G(["MultipleChoice","MultipleSelect","TrueFalse","CodeSnippet"]),questionLevel:G(["EASY","MEDIUM","HARD","EXPERT"]),mark:xe().min(1,"Mark must be at least 1"),questionOptions:pe(Z({content:_().min(1,"Option content is required"),isCorrect:P()})).min(2,"At least two answer options are required").refine(r=>r.some(d=>d.isCorrect),{message:"At least one correct answer is required",path:["questionOptions"]})});function rs({quizId:r,question:d,onSave:D,onCancel:z,onQuestionUpdated:g}){var i;const{toast:E}=ee(),[N,c]=j.useState(!1),[u,q]=j.useState(!1),{control:n,handleSubmit:f,formState:{errors:x},watch:t,setValue:p,trigger:b}=te({resolver:ie(as),defaultValues:{...d,questionOptions:d.questionOptions.map(s=>({content:s.content,isCorrect:s.isCorrect}))}}),{fields:k,append:Q,remove:w}=he({control:n,name:"questionOptions"}),A=t("questionType"),h=t("questionOptions");j.useEffect(()=>{if(A==="MultipleChoice"&&h.filter(a=>a.isCorrect).length>1){const a=h.findIndex(T=>T.isCorrect);h.forEach((T,y)=>{p(`questionOptions.${y}.isCorrect`,y===a)})}b("questionOptions")},[A,h,p,b]),j.useEffect(()=>{h&&(c(!1),b("questionOptions"))},[h,b]);const l=async s=>{if(c(!0),Object.keys(x).length>0)return;q(!0);const a=s.questionOptions.map((y,R)=>({id:y.id,content:y.content,isCorrect:y.isCorrect,orderIndex:R})),T={question:{isActive:s.isActive,content:s.content,questionType:s.questionType,questionLevel:s.questionLevel,mark:s.mark,problemId:d.problemId,problem:d.problem,questionOptions:a}};try{const y=await Ee(r,d.id,T);E({title:"Success",description:"Question updated successfully",duration:1500}),D(y),g()}catch(y){E({title:"Error",description:y.message||"Failed to update question",variant:"destructive",duration:1500})}finally{q(!1)}};return e.jsx(ne,{open:!0,onOpenChange:z,children:e.jsxs(ae,{className:"max-w-[500px] h-[600px] p-0 overflow-hidden flex flex-col",children:[e.jsx(re,{className:"px-6 py-4 border-b",children:e.jsx(le,{className:"text-xl font-semibold",children:"Edit Question"})}),e.jsx(ue,{className:"flex-grow px-6 py-4",children:e.jsxs("form",{onSubmit:f(l),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"content",children:"Question Content"}),e.jsx(o,{name:"content",control:n,render:({field:s})=>e.jsx(F,{id:"content",...s,placeholder:"Enter your question here"})}),N&&x.content&&e.jsx("p",{className:"text-sm text-red-500",children:x.content.message})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{name:"isActive",control:n,render:({field:s})=>e.jsx(O,{id:"isActive",checked:s.value,onCheckedChange:s.onChange})}),e.jsx(m,{htmlFor:"isActive",children:"Active"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"questionType",children:"Question Type"}),e.jsx(o,{name:"questionType",control:n,render:({field:s})=>e.jsxs($,{onValueChange:s.onChange,value:s.value,children:[e.jsx(H,{id:"questionType",children:e.jsx(U,{placeholder:"Select type"})}),e.jsx(Y,{children:is.map(a=>e.jsx(M,{value:a,children:a},a))})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"questionLevel",children:"Difficulty Level"}),e.jsx(o,{name:"questionLevel",control:n,render:({field:s})=>e.jsxs($,{onValueChange:s.onChange,value:s.value,children:[e.jsx(H,{id:"questionLevel",children:e.jsx(U,{placeholder:"Select level"})}),e.jsx(Y,{children:ns.map(a=>e.jsx(M,{value:a,children:a.charAt(0)+a.slice(1).toLowerCase()},a))})]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"mark",children:"Mark"}),e.jsx(o,{name:"mark",control:n,render:({field:s})=>e.jsx(F,{id:"mark",type:"number",...s,onChange:a=>s.onChange(parseInt(a.target.value)),min:1})}),N&&x.mark&&e.jsx("p",{className:"text-sm text-red-500",children:x.mark.message})]}),(A==="MultipleChoice"||A==="MultipleSelect")&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Answer Options"}),e.jsx("div",{className:"max-h-[200px] overflow-y-auto pr-2",children:k.map((s,a)=>{var T,y;return e.jsxs("div",{className:"flex flex-col gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{name:`questionOptions.${a}.content`,control:n,render:({field:R})=>e.jsx(F,{...R,placeholder:`Option ${a+1}`,className:"flex-1"})}),e.jsx(o,{name:`questionOptions.${a}.isCorrect`,control:n,render:({field:{value:R,onChange:oe}})=>e.jsx(O,{checked:R,onCheckedChange:B=>{A==="MultipleChoice"&&B?h.forEach((cs,de)=>{p(`questionOptions.${de}.isCorrect`,de===a)}):oe(B),b("questionOptions")},className:"mx-2"})}),e.jsx(v,{type:"button",variant:"ghost",size:"icon",onClick:()=>w(a),className:"h-8 w-8",disabled:k.length<=2,children:e.jsx(K,{className:"h-4 w-4"})})]}),N&&((y=(T=x.questionOptions)==null?void 0:T[a])==null?void 0:y.content)&&e.jsx("p",{className:"text-sm text-red-500",children:x.questionOptions[a].content.message})]},s.id)})}),N&&x.questionOptions&&"root"in x.questionOptions&&e.jsx("p",{className:"text-sm text-red-500",children:(i=x.questionOptions.root)==null?void 0:i.message}),e.jsxs(v,{type:"button",onClick:()=>Q({content:"",isCorrect:!1}),variant:"outline",className:"w-full mt-2",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Add Answer Option"]})]}),A==="TrueFalse"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Correct Answer"}),e.jsx(o,{name:"questionOptions",control:n,defaultValue:[{content:"True",isCorrect:!0},{content:"False",isCorrect:!1}],render:({field:s})=>e.jsxs($,{onValueChange:a=>s.onChange([{content:"True",isCorrect:a==="True"},{content:"False",isCorrect:a==="False"}]),defaultValue:"True",children:[e.jsx(H,{children:e.jsx(U,{placeholder:"Select correct answer"})}),e.jsxs(Y,{children:[e.jsx(M,{value:"True",children:"True"}),e.jsx(M,{value:"False",children:"False"})]})]})})]})]})}),e.jsxs(ce,{className:"px-6 py-4 border-t",children:[e.jsx(v,{variant:"outline",onClick:z,disabled:u,children:"Cancel"}),e.jsx(v,{onClick:()=>{c(!0),f(l)()},disabled:u,children:u?"Updating...":"Update Question"})]})]})})}function Ne({question:r,onEdit:d,onDelete:D,onToggleActive:z,quizId:g,onQuestionUpdated:E}){const[N,c]=j.useState(!1),[u,q]=j.useState(null),[n,f]=j.useState(!1);j.useEffect(()=>{r.questionType==="CodeSnippet"&&r.problemId&&(async()=>{try{const l=await Be(r.problemId);q(l)}catch(l){console.error("Error fetching problem details:",l)}})()},[r.questionType,r.problemId]);const x=()=>{c(!0)},t=h=>{d(h),c(!1)},p=()=>{f(!0)},b=()=>{D(r.id),f(!1)},k=()=>{f(!1)},Q=()=>{console.log("Editing problem:",u.id)},w=()=>{console.log("Deleting problem:",u.id)},A=h=>{switch(h){case"CodeSnippet":return"bg-blue-100 text-blue-800 border-blue-300";case"MultipleChoice":return"bg-green-100 text-green-800 border-green-300";case"TrueFalse":return"bg-red-100 text-red-800 border-red-300";case"MultipleSelect":return"bg-yellow-100 text-yellow-800 border-yellow-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}};return e.jsxs(e.Fragment,{children:[e.jsxs(S,{className:"mb-4 overflow-hidden",children:[e.jsx(V,{className:"space-y-0 pb-2",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[r.questionType==="CodeSnippet"?e.jsx(Xe,{className:"h-5 w-5 text-blue-500 flex-shrink-0"}):e.jsx(ge,{className:"h-5 w-5 text-green-500 flex-shrink-0"}),e.jsx(X,{className:"text-base sm:text-lg font-semibold line-clamp-2",children:r.content})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(He,{children:e.jsxs(Ue,{children:[e.jsx(Ye,{asChild:!0,children:e.jsx(fe,{variant:r.isActive?"outline":"destructive",className:"text-xs",children:r.isActive?"Active":"Inactive"})}),e.jsx(_e,{children:e.jsx("p",{children:"Question status"})})]})}),e.jsx(v,{variant:"ghost",size:"icon",onClick:x,"aria-label":"Edit question",children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx(v,{variant:"ghost",size:"icon",onClick:p,"aria-label":"Delete question",children:e.jsx(K,{className:"h-4 w-4"})})]})]})}),e.jsxs(L,{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-semibold border ${A(r.questionType)}`,children:r.questionType}),e.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-white-100 text-purple-800 border border-purple-300",children:["Level: ",r.questionLevel]}),e.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-orange-100 text-orange-800 border border-orange-300",children:["Mark: ",r.mark]})]}),e.jsx(Qe,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs(Oe,{value:"details",children:[e.jsx(Fe,{className:"text-sm font-medium",children:e.jsxs("span",{className:"flex items-center",children:["View Details",e.jsx(De,{className:"ml-2 h-4 w-4 text-muted-foreground"})]})}),e.jsxs(Ie,{children:[r.questionType==="CodeSnippet"&&u&&e.jsx(S,{className:"mt-2 mb-4 bg-muted",children:e.jsxs(V,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0 pb-2",children:[e.jsxs(X,{className:"text-sm font-medium",children:["Problem: ",u.problemDto.title]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(v,{variant:"ghost",size:"sm",onClick:Q,className:"h-8",children:[e.jsx(me,{className:"h-3 w-3 mr-1"}),"Edit"]}),e.jsxs(v,{variant:"ghost",size:"sm",onClick:w,className:"h-8",children:[e.jsx(K,{className:"h-3 w-3 mr-1"}),"Delete"]})]})]})}),r.questionType!=="CodeSnippet"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium",children:"Answers:"}),e.jsx("ul",{className:"space-y-1",children:r.questionOptions.map((h,l)=>e.jsxs("li",{className:`flex items-center space-x-2 ${h.isCorrect?"text-green-600":""}`,children:[e.jsx("span",{children:h.isCorrect?"✓":"○"}),e.jsx("span",{className:"text-sm",children:h.content})]},l))})]})]})]})})]})]}),N&&e.jsx(rs,{quizId:g,question:r,onSave:t,onCancel:()=>c(!1),onQuestionUpdated:E}),e.jsx(ve,{open:n,onOpenChange:f,children:e.jsxs(ye,{children:[e.jsxs(Ce,{children:[e.jsx(qe,{children:"Are you sure you want to delete this question?"}),e.jsx(be,{children:"This action cannot be undone. This will permanently delete the question and remove it from the quiz."})]}),e.jsxs(we,{children:[e.jsx(Ae,{onClick:k,children:"Cancel"}),e.jsx(Te,{onClick:b,children:"Delete"})]})]})})]})}Ne.propTypes={question:C.shape({id:C.string.isRequired,content:C.string.isRequired,isActive:C.bool.isRequired,questionType:C.string.isRequired,questionLevel:C.string.isRequired,mark:C.number.isRequired,questionOptions:C.arrayOf(C.shape({content:C.string.isRequired,isCorrect:C.bool.isRequired})).isRequired,problemId:C.string}).isRequired,onEdit:C.func.isRequired,onDelete:C.func.isRequired,onToggleActive:C.func.isRequired};function Is(){const[r,d]=j.useState(!1),[D,z]=j.useState(!1),[g,E]=j.useState(null),[N,c]=j.useState(!1),[u,q]=j.useState(null),[n,f]=j.useState(null),[x,t]=j.useState(!0),{toast:p}=ee();j.useEffect(()=>{b()},[]);const b=async()=>{var i;t(!0);try{const s=await Ve();q(s),E(s.quiz.id),s&&s.quiz&&s.quiz.id&&await k(s.quiz.id)}catch(s){if(((i=s==null?void 0:s.response)==null?void 0:i.status)===404){q(null),f(null);return}console.error("Error fetching quiz assessment:",s),p({title:"Error",description:"Failed to load quiz assessment. Please try again.",variant:"destructive"}),q(null),f(null)}finally{t(!1)}},k=async i=>{t(!0);try{const s=await Me(i);f(s)}catch(s){console.error("Error fetching quiz detail:",s),p({title:"Error",description:"Failed to load quiz details. Please try again.",variant:"destructive"})}finally{t(!1)}},Q=()=>{n&&n.quiz&&n.quiz.id&&k(n.quiz.id)},w=i=>{f(s=>({...s,quiz:{...s.quiz,questions:s.quiz.questions.map(a=>a.id===i.id?i:a)}})),z(!D)},A=async i=>{try{await Pe(n.quiz.id,i),await k(n.quiz.id),p({title:"Success",description:"Question deleted successfully",duration:1500})}catch{p({title:"Error",description:"Failed to delete question. Please try again.",variant:"destructive",duration:1500})}},h=i=>{f(s=>({...s,quiz:{...s.quiz,questions:s.quiz.questions.map(a=>a.id===i?{...a,isActive:!a.isActive}:a)}}))},l=async i=>{try{const s=await je(i);q(s),await k(s.quiz.id),c(!1),p({title:"Success",description:"Quiz created successfully",duration:1500})}catch(s){console.error("Error creating quiz:",s),p({title:"Error",description:"Failed to create quiz. Please try again.",variant:"destructive",duration:1500})}};return x?e.jsx("div",{className:"container p-4 mx-auto space-y-6",children:e.jsx(ls,{})}):e.jsxs("div",{className:"container p-4 mx-auto space-y-6",children:[n?e.jsxs(e.Fragment,{children:[e.jsxs(S,{className:"w-full",children:[e.jsx(V,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(X,{className:"text-2xl font-bold",children:n.quiz.title}),e.jsx(fe,{variant:n.quiz.isActive?"success":"secondary",children:n.quiz.isActive?"Active":"Inactive"})]})}),e.jsx(L,{className:"pt-0",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-muted",children:e.jsx(ge,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:"Quiz Type"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n.quiz.quizType})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-muted",children:e.jsx(Re,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:"Passing Mark"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n.quiz.passingMark})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-muted",children:e.jsx(Ze,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:"Time Limit"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n.quiz.hasTimeLimit?`${n.quiz.timeLimit} minutes`:"No limit"})]})]}),e.jsx(O,{checked:n.quiz.hasTimeLimit})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-muted",children:e.jsx(Ge,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:"Attempt Limit"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n.quiz.hasAttemptLimit?`${n.quiz.attemptLimit} attempts`:"No limit"})]})]}),e.jsx(O,{checked:n.quiz.hasAttemptLimit})]})]})]})})]}),e.jsxs(S,{className:"md:col-span-2",children:[e.jsxs(V,{className:"flex flex-row items-center justify-between",children:[e.jsx(X,{children:"Questions"}),e.jsxs(v,{onClick:()=>d(!0),children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Add Question"]})]}),e.jsx(L,{children:e.jsx("div",{className:"space-y-4",children:n.quiz.questions.length>0?n.quiz.questions.map(i=>e.jsx(Ne,{quizId:n.quiz.id,question:i,onEdit:w,onDelete:A,onToggleActive:h,onQuestionUpdated:Q},i.id)):e.jsx("p",{className:"text-center text-muted-foreground",children:"No questions added yet."})})})]})]}):e.jsx(S,{children:e.jsx(L,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"mb-4 text-lg",children:"No Quiz Assessment found"}),e.jsxs(v,{onClick:()=>c(!0),children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Create Quiz Assessment"]})]})})}),r&&e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50",children:e.jsx("div",{className:"container flex items-center justify-center h-full max-w-lg mx-auto",children:e.jsxs(S,{className:"w-full",children:[e.jsx(V,{children:e.jsx(X,{children:"Add New Question"})}),e.jsx(L,{children:e.jsx(es,{quizId:n.quiz.id,onQuestionAdded:Q,onClose:()=>d(!1)})})]})})}),N&&e.jsx(ts,{isOpen:N,onOpenChange:c,onSubmit:l})]})}const ls=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx(I,{className:"w-40 h-10"}),e.jsxs(S,{children:[e.jsx(V,{children:e.jsx(I,{className:"w-3/4 h-8"})}),e.jsxs(L,{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(I,{className:"w-full h-6"}),e.jsx(I,{className:"w-full h-6"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(I,{className:"w-full h-6"}),e.jsx(I,{className:"w-full h-6"})]})]})]}),e.jsxs(S,{children:[e.jsxs(V,{className:"flex flex-row items-center justify-between",children:[e.jsx(I,{className:"w-1/4 h-8"}),e.jsx(I,{className:"w-40 h-10"})]}),e.jsx(L,{children:e.jsx("div",{className:"space-y-4",children:[1,2,3].map(r=>e.jsx(I,{className:"w-full h-24"},r))})})]})]});export{Is as default};
//# sourceMappingURL=QuizAssessment-C9MqHpA8.js.map
