<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Callback</title>
</head>
<body>
    <h1>Processing login...</h1>

    <script src="oidc-client.js"></script>

    <script>
        // Tạo một UserManager từ thư viện OIDC để xử lý phản hồi của IdentityServer.
        // response_mode: "query" chỉ định rằng response (mã authorization code) sẽ được truyền qua query string (URL).
        new Oidc.UserManager({ response_mode: "query" })

            // Phương thức signinRedirectCallback sẽ xử lý mã ủy quyền được trả về từ IdentityServer
            .signinRedirectCallback()

            // Nếu thành công, nó sẽ trả về đối tượng 'user' chứa thông tin của người dùng và token.
            .then(function (user) {
                console.log("Login successful: ", user);
                // Sau khi xử lý thành công, chuyển hướng người dùng về lại trang chính 'index.html'.
                window.location = "index.html";
            })

            // Bắt lỗi nếu có vấn đề xảy ra trong quá trình xử lý callback
            .catch(function (e) {
                console.error("Error during login callback:", e);
            });
    </script>
</body>
</html>
